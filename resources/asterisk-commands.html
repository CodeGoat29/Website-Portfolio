<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asterisk Commands - DiPiazza</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="icon" type="image/png" href="../images/thegoat.png">
    <style>
        /* Override grid for asterisk commands - full width cards */
        .command-category .category-content {
            grid-template-columns: 1fr !important;
        }

        /* Better collapse animation */
        .category-content {
            display: grid;
            transition: opacity 0.2s ease-out;
            opacity: 1;
        }

        .category-content.collapsed {
            display: none;
            opacity: 0;
        }

        /* Input boxes for placeholders */
        .placeholder-inputs {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .placeholder-input {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .dark-mode .placeholder-input {
            background: #0f1419;
            color: var(--primary-blue);
            border-color: #2a3f5f;
        }

        .placeholder-input::placeholder {
            color: #8899a6;
        }

        .placeholder-label {
            font-size: 0.85em;
            color: #657786;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .dark-mode .placeholder-label {
            color: #8899a6;
        }

        .input-group {
            flex: 1;
            min-width: 200px;
        }

        /* Search Modal */
        .search-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .search-modal.show {
            display: flex;
        }

        .search-modal-content {
            background: white;
            padding: 32px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .dark-mode .search-modal-content {
            background: #1c2938;
        }

        .search-modal h3 {
            color: var(--primary-blue);
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .search-modal-input {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
        }

        .dark-mode .search-modal-input {
            background: #0f1419;
            color: var(--primary-blue);
            border-color: #2a3f5f;
        }

        .search-modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .search-modal-btn {
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .search-modal-btn.btn-search {
            background: var(--primary-blue);
            color: white;
        }

        .search-modal-btn.btn-search:hover {
            background: var(--main-blue);
        }

        .search-modal-btn.btn-cancel {
            background: #e1e8ed;
            color: #2c3e50;
        }

        .dark-mode .search-modal-btn.btn-cancel {
            background: #2a3f5f;
            color: #e4e6eb;
        }

        .search-modal-btn.btn-cancel:hover {
            background: #657786;
            color: white;
        }
    </style>
</head>
<body>
    <div class="top-controls">
        <div class="dark-mode-toggle">
            <input type="checkbox" id="darkModeToggle" class="toggle-checkbox">
            <label for="darkModeToggle" class="toggle-label">
                <span class="toggle-switch"></span>
            </label>
        </div>
    </div>

    <header>
        <div class="container header-content">
            <img src="../images/thegoat.png" alt="DiPiazza Logo" class="logo">
            <div class="header-text">
                <h1>DiPiazza</h1>
                <p class="tagline">Where I break stuff, then write about it.</p>
            </div>
        </div>
        <nav>
            <div class="container">
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="../resume.html">Resume</a></li>
                    <li><a href="../index.html#blog">Blog</a></li>
                    <li><a href="../index.html#resources" class="active">Resources</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="container">
        <section class="notes-header commands-header">
            <h1>Asterisk Command Reference</h1>
            <p class="subtitle">Quick reference guide for VoIP troubleshooting and server management</p>
            
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search commands, descriptions, or categories..." autocomplete="off">
                <span class="search-icon">üîç</span>
            </div>

            <div class="quick-nav">
                <h3>Quick Navigation</h3>
                <div class="nav-links">
                    <a href="#network" class="nav-link">Network Diagnostics</a>
                    <a href="#grep" class="nav-link">Log Analysis</a>
                    <a href="#asterisk" class="nav-link">Asterisk Management</a>
                    <a href="#system" class="nav-link">System Resources</a>
                    <a href="#fail2ban" class="nav-link">Fail2Ban</a>
                    <a href="#extensions" class="nav-link">Extensions</a>
                    <a href="#files" class="nav-link">File Locations</a>
                    <a href="#find" class="nav-link">Find Commands</a>
                </div>
            </div>
        </section>

        <div class="favorites-section" id="favoritesSection" style="display: none;">
            <h2>‚≠ê Favorite Commands</h2>
            <div id="favoritesList" class="favorites-list"></div>
        </div>

        <section id="network" class="command-category">
            <h2 class="category-toggle">Network Diagnostics</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="network dns ip lookup nslookup">
                <div class="command-header">
                    <h3>DNS Lookup & Public IP</h3>
                    <button class="favorite-btn" data-command="nslookup">‚òÜ</button>
                </div>
                <p class="command-description">Resolves domain names to IP addresses and retrieves your public IP address using OpenDNS resolver.</p>
                <div class="command-block">
                    <code>nslookup myip.opendns.com. resolver1.opendns.com</code>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="command-notes">
                    <strong>Use case:</strong> Quickly determine the public IP address of a client or server without visiting external websites.
                </div>
            </div>

            <div class="command-card" data-tags="network trace tracert path routing">
                <div class="command-header">
                    <h3>Trace Route</h3>
                    <button class="favorite-btn" data-command="tracert">‚òÜ</button>
                </div>
                <p class="command-description">Maps the complete network path packets take from source to destination.</p>
                <div class="placeholder-inputs">
                    <div class="input-group">
                        <div class="placeholder-label">Destination:</div>
                        <input type="text" class="placeholder-input" data-field="destination" placeholder="example.com or IP address">
                    </div>
                </div>
                <div class="command-block" data-template="tracert {destination}">
                    <code>tracert <span class="placeholder">destination</span></code>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="command-notes">
                    <strong>Use case:</strong> Diagnose where network delays or failures occur in the routing path.
                </div>
            </div>

            <div class="command-card" data-tags="network ping connectivity">
                <div class="command-header">
                    <h3>Ping Test</h3>
                    <button class="favorite-btn" data-command="ping">‚òÜ</button>
                </div>
                <p class="command-description">Tests network connectivity and measures round-trip time.</p>
                <div class="placeholder-inputs">
                    <div class="input-group">
                        <div class="placeholder-label">Hostname or IP:</div>
                        <input type="text" class="placeholder-input" data-field="host" placeholder="example.com or IP address">
                    </div>
                </div>
                <div class="command-block" data-template="ping {host}">
                    <code>ping <span class="placeholder">hostname</span></code>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="command-block" data-template="ping -t {host}">
                    <code>ping -t <span class="placeholder">hostname</span></code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="network arp mac address">
                <div class="command-header">
                    <h3>ARP Table</h3>
                    <button class="favorite-btn" data-command="arp">‚òÜ</button>
                </div>
                <p class="command-description">Displays the Address Resolution Protocol table.</p>
                <div class="command-block">
                    <code>arp -a</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="mtr traceroute ping network">
                <div class="command-header">
                    <h3>MTR - Network Path Analysis</h3>
                    <button class="favorite-btn" data-command="mtr">‚òÜ</button>
                </div>
                <p class="command-description">Combines traceroute and ping functionality.</p>
                <div class="placeholder-inputs">
                    <div class="input-group">
                        <div class="placeholder-label">Hostname or IP:</div>
                        <input type="text" class="placeholder-input" data-field="host" placeholder="example.com or IP address">
                    </div>
                </div>
                <div class="command-block" data-template="sudo mtr {host}">
                    <code>sudo mtr <span class="placeholder">hostname</span></code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <section id="grep" class="command-category">
            <h2 class="category-toggle">Log Analysis (Grep)</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="grep log search">
                <div class="command-header">
                    <h3>Search Current Day Logs</h3>
                    <button class="favorite-btn" data-command="grep-current">‚òÜ</button>
                </div>
                <p class="command-description">Search today's Asterisk full log for specific keywords.</p>
                <div class="command-block" data-has-search="true" data-template="grep -i {search} /var/log/asterisk/full">
                    <code>grep -i <span class="placeholder">searchword</span> /var/log/asterisk/full</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="grep recursive search">
                <div class="command-header">
                    <h3>Recursive Grep</h3>
                    <button class="favorite-btn" data-command="grep-recursive">‚òÜ</button>
                </div>
                <p class="command-description">Recursively search through all files.</p>
                <div class="command-block" data-has-search="true" data-template='grep -r "{search}" /var/log/asterisk/'>
                    <code>grep -r "<span class="placeholder">searchword</span>" /var/log/asterisk/</code>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="command-block" data-has-search="true" data-template='grep -ri "{search}" /var/log/asterisk/'>
                    <code>grep -ri "<span class="placeholder">searchword</span>" /var/log/asterisk/</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="grep zgrep historical">
                <div class="command-header">
                    <h3>Search Historical Logs</h3>
                    <button class="favorite-btn" data-command="zgrep">‚òÜ</button>
                </div>
                <p class="command-description">Search compressed archived logs.</p>
                <div class="command-block" data-has-search="true" data-template='zgrep -i "{search}" /var/log/asterisk/full*.*'>
                    <code>zgrep -i "<span class="placeholder">searchword</span>" /var/log/asterisk/full*.*</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="grep oom memory">
                <div class="command-header">
                    <h3>Check for OOM Killer Events</h3>
                    <button class="favorite-btn" data-command="grep-oom">‚òÜ</button>
                </div>
                <p class="command-description">Search for Out-Of-Memory killer events.</p>
                <div class="command-block">
                    <code>grep -i oom /var/log/syslog</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <section id="asterisk" class="command-category">
            <h2 class="category-toggle">Asterisk Management</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="asterisk status">
                <div class="command-header">
                    <h3>Check Asterisk Status</h3>
                    <button class="favorite-btn" data-command="asterisk-status">‚òÜ</button>
                </div>
                <p class="command-description">View the current status of the Asterisk service.</p>
                <div class="command-block">
                    <code>systemctl status asterisk</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="asterisk channel hangup">
                <div class="command-header">
                    <h3>Hangup Specific Channel</h3>
                    <button class="favorite-btn" data-command="channel-hangup">‚òÜ</button>
                </div>
                <p class="command-description">Forcefully terminate a specific channel.</p>
                <div class="placeholder-inputs">
                    <div class="input-group">
                        <div class="placeholder-label">Channel Name:</div>
                        <input type="text" class="placeholder-input" data-field="channel" placeholder="channel name">
                    </div>
                </div>
                <div class="command-block" data-template="sudo channel request hangup '{channel}'">
                    <code>sudo channel request hangup '<span class="placeholder">channel name</span>'</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="asterisk restart">
                <div class="command-header">
                    <h3>Restart Asterisk Service</h3>
                    <button class="favorite-btn" data-command="asterisk-restart">‚òÜ</button>
                </div>
                <p class="command-description">Completely restart the Asterisk service.</p>
                <div class="command-block">
                    <code>sudo systemctl restart asterisk</code>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="command-notes">
                    <strong>‚ö†Ô∏è Warning:</strong> This terminates all active calls.
                </div>
            </div>

            <div class="command-card" data-tags="switchboard restart sb">
                <div class="command-header">
                    <h3>Restart Switchboard</h3>
                    <button class="favorite-btn" data-command="sb-restart">‚òÜ</button>
                </div>
                <p class="command-description">Restart the switchboard service.</p>
                <div class="command-block">
                    <code>sudo systemctl restart sb</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="apache restart web">
                <div class="command-header">
                    <h3>Restart Apache</h3>
                    <button class="favorite-btn" data-command="apache-restart">‚òÜ</button>
                </div>
                <p class="command-description">Restart the Apache web server.</p>
                <div class="command-block">
                    <code>sudo systemctl restart apache2</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="asterisk version">
                <div class="command-header">
                    <h3>Check Asterisk Version</h3>
                    <button class="favorite-btn" data-command="asterisk-version">‚òÜ</button>
                </div>
                <p class="command-description">Display the current Asterisk version.</p>
                <div class="command-block">
                    <code>sudo asterisk -rx 'core show version'</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="voicemail users">
                <div class="command-header">
                    <h3>Show Voicemail Users</h3>
                    <button class="favorite-btn" data-command="voicemail-users">‚òÜ</button>
                </div>
                <p class="command-description">Display all configured voicemail boxes.</p>
                <div class="command-block">
                    <code>sudo asterisk -rx 'voicemail show users'</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="hints blf">
                <div class="command-header">
                    <h3>Show Hints/BLF Status</h3>
                    <button class="favorite-btn" data-command="hints">‚òÜ</button>
                </div>
                <p class="command-description">Display all configured hints for BLF monitoring.</p>
                <div class="command-block">
                    <code>sudo asterisk -rx 'core show hints'</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="dialplan show">
                <div class="command-header">
                    <h3>Show Dialplan</h3>
                    <button class="favorite-btn" data-command="dialplan">‚òÜ</button>
                </div>
                <p class="command-description">Display the complete dialplan configuration.</p>
                <div class="command-block">
                    <code>sudo asterisk -rx 'dialplan show'</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="channels watch monitor">
                <div class="command-header">
                    <h3>Monitor Channels (Auto-Refresh)</h3>
                    <button class="favorite-btn" data-command="watch-channels">‚òÜ</button>
                </div>
                <p class="command-description">Continuously monitor active channels.</p>
                <div class="command-block">
                    <code>watch -n 1 'sudo asterisk -rx "core show channels verbose"'</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <section id="system" class="command-category">
            <h2 class="category-toggle">System Resources & Performance</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="cpu cores">
                <div class="command-header">
                    <h3>View CPU Information</h3>
                    <button class="favorite-btn" data-command="cpu-info">‚òÜ</button>
                </div>
                <p class="command-description">Display CPU architecture information.</p>
                <div class="command-block">
                    <code>lscpu</code>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="command-block">
                    <code>nproc</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="disk space df">
                <div class="command-header">
                    <h3>Check Disk Space</h3>
                    <button class="favorite-btn" data-command="df">‚òÜ</button>
                </div>
                <p class="command-description">Display available disk space.</p>
                <div class="command-block">
                    <code>df -h</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="memory ram free">
                <div class="command-header">
                    <h3>Check Memory Usage</h3>
                    <button class="favorite-btn" data-command="free">‚òÜ</button>
                </div>
                <p class="command-description">Display current memory usage.</p>
                <div class="command-block">
                    <code>free -h</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="top processes">
                <div class="command-header">
                    <h3>Monitor Running Processes</h3>
                    <button class="favorite-btn" data-command="top">‚òÜ</button>
                </div>
                <p class="command-description">Real-time view of system processes.</p>
                <div class="command-block">
                    <code>top</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="uptime load">
                <div class="command-header">
                    <h3>System Uptime & Load</h3>
                    <button class="favorite-btn" data-command="uptime">‚òÜ</button>
                </div>
                <p class="command-description">Show system uptime and load averages.</p>
                <div class="command-block">
                    <code>uptime</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <section id="fail2ban" class="command-category">
            <h2 class="category-toggle">Fail2Ban Management</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="fail2ban status">
                <div class="command-header">
                    <h3>Check Fail2Ban Status</h3>
                    <button class="favorite-btn" data-command="fail2ban-status">‚òÜ</button>
                </div>
                <p class="command-description">View the current status of Fail2Ban.</p>
                <div class="command-block">
                    <code>sudo systemctl status fail2ban</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="fail2ban restart">
                <div class="command-header">
                    <h3>Restart Fail2Ban</h3>
                    <button class="favorite-btn" data-command="fail2ban-restart">‚òÜ</button>
                </div>
                <p class="command-description">Restart the Fail2Ban service.</p>
                <div class="command-block">
                    <code>sudo systemctl restart fail2ban</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <section id="extensions" class="command-category">
            <h2 class="category-toggle">Extension Management</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="extension peers">
                <div class="command-header">
                    <h3>List All Extensions</h3>
                    <button class="favorite-btn" data-command="peers-all">‚òÜ</button>
                </div>
                <p class="command-description">Display all configured PJSIP contacts/extensions.</p>
                <div class="command-block">
                    <code>sudo asterisk -rx 'pjsip show contacts'</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <section id="files" class="command-category">
            <h2 class="category-toggle">Important File Locations</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="files logs">
                <div class="command-header">
                    <h3>Asterisk Log Files</h3>
                    <button class="favorite-btn" data-command="log-location">‚òÜ</button>
                </div>
                <p class="command-description">Primary location for all Asterisk log files.</p>
                <div class="command-block">
                    <code>/var/log/asterisk</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="files voicemail">
                <div class="command-header">
                    <h3>Voicemail Storage</h3>
                    <button class="favorite-btn" data-command="voicemail-location">‚òÜ</button>
                </div>
                <p class="command-description">Directory where voicemail recordings are stored.</p>
                <div class="command-block">
                    <code>/var/spool/asterisk/voicemail/default</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <section id="find" class="command-category">
            <h2 class="category-toggle">Find Commands</h2>
            <div class="category-content">
            
            <div class="command-card" data-tags="find search file">
                <div class="command-header">
                    <h3>Find File by Name</h3>
                    <button class="favorite-btn" data-command="find-name">‚òÜ</button>
                </div>
                <p class="command-description">Search the entire filesystem for a file.</p>
                <div class="placeholder-inputs">
                    <div class="input-group">
                        <div class="placeholder-label">Filename:</div>
                        <input type="text" class="placeholder-input" data-field="filename" placeholder="filename.ext">
                    </div>
                </div>
                <div class="command-block" data-template="find / -name {filename} 2>/dev/null">
                    <code>find / -name <span class="placeholder">filename.ext</span> 2>/dev/null</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            <div class="command-card" data-tags="find directory">
                <div class="command-header">
                    <h3>Find Directory by Name</h3>
                    <button class="favorite-btn" data-command="find-directory">‚òÜ</button>
                </div>
                <p class="command-description">Search for directories/folders by name.</p>
                <div class="placeholder-inputs">
                    <div class="input-group">
                        <div class="placeholder-label">Directory Name:</div>
                        <input type="text" class="placeholder-input" data-field="dirname" placeholder="directory_name">
                    </div>
                </div>
                <div class="command-block" data-template="find / -type d -name {dirname} 2>/dev/null">
                    <code>find / -type d -name <span class="placeholder">directory_name</span> 2>/dev/null</code>
                    <button class="copy-btn">Copy</button>
                </div>
            </div>

            </div>
        </section>

        <button class="back-to-top" id="backToTop">‚Üë</button>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 DiPiazza.org | All Rights Reserved</p>
        </div>
    </footer>

    <!-- Search Modal -->
    <div class="search-modal" id="searchModal">
        <div class="search-modal-content">
            <h3>Enter Search Term</h3>
            <input type="text" class="search-modal-input" id="searchModalInput" placeholder="Enter keyword to search...">
            <div class="search-modal-buttons">
                <button class="search-modal-btn btn-cancel" id="searchModalCancel">Cancel</button>
                <button class="search-modal-btn btn-search" id="searchModalSearch">Copy Command</button>
            </div>
        </div>
    </div>

    <script>
        // Dark mode
        const darkModeToggle = document.getElementById('darkModeToggle');
        const body = document.body;
        if (localStorage.getItem('darkMode') === 'enabled') {
            body.classList.add('dark-mode');
            darkModeToggle.checked = true;
        }
        darkModeToggle.addEventListener('change', () => {
            body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', body.classList.contains('dark-mode') ? 'enabled' : 'disabled');
        });

        // Search functionality - FIXED
        const searchInput = document.getElementById('searchInput');
        
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase().trim();
            const commandCards = document.querySelectorAll('.command-card');
            
            commandCards.forEach(card => {
                const tags = (card.getAttribute('data-tags') || '').toLowerCase();
                const title = (card.querySelector('h3')?.textContent || '').toLowerCase();
                const description = (card.querySelector('.command-description')?.textContent || '').toLowerCase();
                const notes = (card.querySelector('.command-notes')?.textContent || '').toLowerCase();
                
                const searchable = `${tags} ${title} ${description} ${notes}`;
                
                if (searchTerm === '' || searchable.includes(searchTerm)) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });

            // Auto-expand categories with visible cards
            document.querySelectorAll('.command-category').forEach(category => {
                const visibleCards = Array.from(category.querySelectorAll('.command-card')).filter(card => card.style.display !== 'none');
                const categoryContent = category.querySelector('.category-content');
                const categoryToggle = category.querySelector('.category-toggle');
                
                if (searchTerm !== '' && visibleCards.length > 0) {
                    categoryContent.classList.remove('collapsed');
                    categoryToggle.classList.remove('collapsed');
                }
            });
        });

        // Category toggle - FIXED
        document.querySelectorAll('.category-toggle').forEach(toggle => {
            toggle.addEventListener('click', () => {
                const content = toggle.nextElementSibling;
                toggle.classList.toggle('collapsed');
                content.classList.toggle('collapsed');
            });
        });

        // Copy functionality with input support and search modal
        let currentSearchButton = null;

        function showSearchModal(btn) {
            currentSearchButton = btn;
            const modal = document.getElementById('searchModal');
            const input = document.getElementById('searchModalInput');
            modal.classList.add('show');
            input.value = '';
            input.focus();
        }

        document.getElementById('searchModalCancel').addEventListener('click', () => {
            document.getElementById('searchModal').classList.remove('show');
            currentSearchButton = null;
        });

        document.getElementById('searchModalSearch').addEventListener('click', () => {
            if (currentSearchButton) {
                const searchValue = document.getElementById('searchModalInput').value.trim();
                if (!searchValue) {
                    alert('Please enter a search term');
                    return;
                }
                
                const commandBlock = currentSearchButton.parentElement;
                const template = commandBlock.getAttribute('data-template');
                const text = template.replace(/{search}/g, searchValue);
                
                navigator.clipboard.writeText(text).then(() => {
                    currentSearchButton.textContent = 'Copied!';
                    currentSearchButton.classList.add('copied');
                    setTimeout(() => {
                        currentSearchButton.textContent = 'Copy';
                        currentSearchButton.classList.remove('copied');
                    }, 2000);
                });
                
                document.getElementById('searchModal').classList.remove('show');
                currentSearchButton = null;
            }
        });

        // Enter key in modal
        document.getElementById('searchModalInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('searchModalSearch').click();
            }
        });

        // Click outside modal to close
        document.getElementById('searchModal').addEventListener('click', (e) => {
            if (e.target.id === 'searchModal') {
                document.getElementById('searchModal').classList.remove('show');
                currentSearchButton = null;
            }
        });

        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const commandBlock = this.parentElement;
                const hasSearch = commandBlock.getAttribute('data-has-search') === 'true';
                
                if (hasSearch) {
                    showSearchModal(this);
                    return;
                }
                
                const card = commandBlock.closest('.command-card');
                const template = commandBlock.getAttribute('data-template');
                
                let text;
                if (template) {
                    text = template;
                    const inputs = card.querySelectorAll('.placeholder-input');
                    inputs.forEach(input => {
                        const field = input.getAttribute('data-field');
                        const value = input.value.trim() || input.placeholder;
                        text = text.replace(`{${field}}`, value);
                    });
                } else {
                    const code = commandBlock.querySelector('code');
                    text = code.textContent;
                }
                
                navigator.clipboard.writeText(text).then(() => {
                    this.textContent = 'Copied!';
                    this.classList.add('copied');
                    setTimeout(() => {
                        this.textContent = 'Copy';
                        this.classList.remove('copied');
                    }, 2000);
                });
            });
        });

        // Update command display when inputs change
        document.querySelectorAll('.placeholder-input').forEach(input => {
            input.addEventListener('input', function() {
                const card = this.closest('.command-card');
                const field = this.getAttribute('data-field');
                const value = this.value || this.placeholder;
                
                // Update all placeholders in this card's command blocks
                card.querySelectorAll('.command-block[data-template]').forEach(block => {
                    const placeholder = block.querySelector('.placeholder');
                    if (block.getAttribute('data-template').includes(`{${field}}`)) {
                        placeholder.textContent = value;
                    }
                });
            });
        });

        // Back to top
        const backToTop = document.getElementById('backToTop');
        window.addEventListener('scroll', () => {
            backToTop.classList.toggle('show', window.scrollY > 300);
        });
        backToTop.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Favorites functionality
        let favorites = JSON.parse(localStorage.getItem('favoriteCommands') || '[]');

        function updateFavoritesDisplay() {
            const favoritesSection = document.getElementById('favoritesSection');
            const favoritesList = document.getElementById('favoritesList');
            
            if (favorites.length === 0) {
                favoritesSection.style.display = 'none';
                return;
            }
            
            favoritesSection.style.display = 'block';
            favoritesList.innerHTML = '';
            
            favorites.forEach(commandId => {
                const originalCard = document.querySelector(`[data-command="${commandId}"]`)?.closest('.command-card');
                if (originalCard) {
                    const clone = originalCard.cloneNode(true);
                    clone.querySelector('.favorite-btn')?.remove();
                    
                    // Re-attach copy button functionality to cloned buttons
                    clone.querySelectorAll('.copy-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const commandBlock = this.parentElement;
                            const hasSearch = commandBlock.getAttribute('data-has-search') === 'true';
                            
                            if (hasSearch) {
                                currentSearchButton = this;
                                const modal = document.getElementById('searchModal');
                                const input = document.getElementById('searchModalInput');
                                modal.classList.add('show');
                                input.value = '';
                                input.focus();
                                return;
                            }
                            
                            const card = commandBlock.closest('.command-card');
                            const template = commandBlock.getAttribute('data-template');
                            
                            let text;
                            if (template) {
                                text = template;
                                const inputs = card.querySelectorAll('.placeholder-input');
                                inputs.forEach(input => {
                                    const field = input.getAttribute('data-field');
                                    const value = input.value.trim() || input.placeholder;
                                    text = text.replace(`{${field}}`, value);
                                });
                            } else {
                                const code = commandBlock.querySelector('code');
                                text = code.textContent;
                            }
                            
                            navigator.clipboard.writeText(text).then(() => {
                                this.textContent = 'Copied!';
                                this.classList.add('copied');
                                setTimeout(() => {
                                    this.textContent = 'Copy';
                                    this.classList.remove('copied');
                                }, 2000);
                            });
                        });
                    });
                    
                    favoritesList.appendChild(clone);
                }
            });
        }

        document.querySelectorAll('.favorite-btn').forEach(btn => {
            const commandId = btn.getAttribute('data-command');
            if (favorites.includes(commandId)) {
                btn.classList.add('active');
                btn.textContent = '‚òÖ';
            }
            
            btn.addEventListener('click', function() {
                const commandId = this.getAttribute('data-command');
                if (favorites.includes(commandId)) {
                    favorites = favorites.filter(id => id !== commandId);
                    this.classList.remove('active');
                    this.textContent = '‚òÜ';
                } else {
                    favorites.push(commandId);
                    this.classList.add('active');
                    this.textContent = '‚òÖ';
                }
                localStorage.setItem('favoriteCommands', JSON.stringify(favorites));
                updateFavoritesDisplay();
            });
        });

        updateFavoritesDisplay();

        // Smooth scroll for quick navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href');
                const targetSection = document.querySelector(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>
